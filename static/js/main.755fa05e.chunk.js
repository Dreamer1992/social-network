(this.webpackJsonpsocial=this.webpackJsonpsocial||[]).push([[0],{132:function(e,t,r){},133:function(e,t,r){e.exports={preloaderWrapper:"Preloader_preloaderWrapper__3-Lwp"}},134:function(e,t,r){e.exports={profile:"Profile_profile__1ZuET"}},135:function(e,t,r){e.exports={post:"Post_post__364Kw"}},136:function(e,t,r){e.exports={profileTopBg:"ProfileInfo_profileTopBg__3et6T",profileAvatar:"ProfileInfo_profileAvatar__2uvdS"}},242:function(e,t,r){},246:function(e,t,r){},28:function(e,t,r){e.exports={contactItem:"ProfileData_contactItem__tGSWT",profileDataForm:"ProfileData_profileDataForm__3aWh1",formGroup:"ProfileData_formGroup__2N8lg",hasError:"ProfileData_hasError__38byX"}},288:function(e,t,r){"use strict";r.r(t);var n=r(0);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=r(8),a=r(9),o=r.n(a),c=r(15),i=r(37),u=r(3),l=r(128).create({withCredentials:!0,baseURL:"https://social-network.samuraijs.com/api/1.0/",headers:{"api-key":"5c0f0a90-5afa-4259-9e1c-ae6776e803f5"}}),j={getUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return l.get("users?page=".concat(e,"&count=").concat(t)).then((function(e){return e.data}))},unfollow:function(e){return l.delete("follow/".concat(e))},follow:function(e){return l.post("follow/".concat(e))},getUserProfile:function(e){return console.warn("Obsolete method. Please use profileAPI object"),d.getUserProfile(e)}},d={getUserProfile:function(e){return l.get("profile/".concat(e)).then((function(e){return e.data}))},getUserStatus:function(e){return l.get("profile/status/".concat(e))},updateUserStatus:function(e){return l.put("profile/status",{status:e})},savePhoto:function(e){var t=new FormData;return t.append("image",e),l.put("profile/photo",t)},saveProfile:function(e){return l.put("/profile",e)}},p=function(){return l.get("auth/me").then((function(e){return e.data}))},f=function(e,t,r){return l.post("auth/login",{email:e,password:t,rememberMe:r})},b=function(){return l.delete("auth/login")},h=function(){return l.get("security/get-captcha-url")},O=r(27),m="ADD_POST",g="DELETE_POST",x="SET_USER_PROFILE",v="SET_USER_STATUS",P="SAVE_PHOTO_SUCCESS",_={posts:[{id:1,message:"Hi, how are you?",like:10},{id:2,message:"It's my first post",like:17}],newPostText:"it-kamasutra",profile:null,status:""},w=function(e){return{type:v,status:e}},S=function(e){return function(t){j.getUserProfile(e).then((function(e){t({type:x,profile:e})}))}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:var r={id:6,message:t.newPostText,like:0};return Object(u.a)(Object(u.a)({},e),{},{newPostText:"",posts:[].concat(Object(i.a)(e.posts),[r])});case g:return Object(u.a)(Object(u.a)({},e),{},{posts:e.posts.filter((function(e){return e.id!==t.postId}))});case x:return Object(u.a)(Object(u.a)({},e),{},{profile:t.profile});case v:return Object(u.a)(Object(u.a)({},e),{},{status:t.status});case P:return Object(u.a)(Object(u.a)({},e),{},{profile:Object(u.a)(Object(u.a)({},e.profile),{},{photos:t.photos})});default:return e}},C="SEND-MESSAGE",U={dialogs:[{id:1,name:"Alex"},{id:2,name:"Petr"},{id:3,name:"Igor"},{id:4,name:"Lera"},{id:5,name:"Nina"}],messages:[{id:1,message:"Hi"},{id:2,message:"How are you?"},{id:3,message:"Yo"}]},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:var r=t.newMessageText;return Object(u.a)(Object(u.a)({},e),{},{messages:[].concat(Object(i.a)(e.messages),[{id:4,message:r}])});default:return e}},k={},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k;return e},T="FOLLOW",E="UNFOLLOW",A="SET_USERS",F="SET_CURRENT_PAGE",L="SET_TOTAL_USERS_COUNT",M="TOGGLE_IS_FETCHING",D="TOGGLE_IS_FOLLOWING_PROGRESS",G={users:[],pageSize:10,totalUsersCount:0,currentPage:1,isFetching:!0,followingInProgress:[]},z=function(e){return{type:T,userId:e}},W=function(e){return{type:E,userId:e}},R=function(e){return{type:M,isFetching:e}},V=function(e,t){return{type:D,isFetching:e,userId:t}},H=function(){var e=Object(c.a)(o.a.mark((function e(t,r,n,s){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(V(!0,r)),e.next=3,n(r);case 3:0===e.sent.data.resultCode&&t(s(r)),t(V(!1,r));case 6:case"end":return e.stop()}}),e)})));return function(t,r,n,s){return e.apply(this,arguments)}}(),J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return Object(u.a)(Object(u.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userId?Object(u.a)(Object(u.a)({},e),{},{followed:!0}):e}))});case E:return Object(u.a)(Object(u.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userId?Object(u.a)(Object(u.a)({},e),{},{followed:!1}):e}))});case A:return Object(u.a)(Object(u.a)({},e),{},{users:Object(i.a)(t.users)});case F:return Object(u.a)(Object(u.a)({},e),{},{currentPage:t.currentPage});case L:return Object(u.a)(Object(u.a)({},e),{},{totalUsersCount:t.count});case M:return Object(u.a)(Object(u.a)({},e),{},{isFetching:t.isFetching});case D:return Object(u.a)(Object(u.a)({},e),{},{followingInProgress:t.isFetching?[].concat(Object(i.a)(e.followingInProgress),[t.userId]):e.followingInProgress.filter((function(e){return e!==t.userId}))});default:return e}},B="SET_USER_DATA",X="GET_CAPTCHA_URL_SUCCESS",K={userId:null,email:null,login:null,isAuth:!1,captchaUrl:null},Y=function(e,t,r,n){return{type:B,payload:{userId:e,email:t,login:r,isAuth:n}}},Z=function(e){return{type:X,payload:{captchaUrl:e}}},q=function(){return function(){var e=Object(c.a)(o.a.mark((function e(t){var r,n,s,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:0===(r=e.sent).resultCode&&(n=r.data,s=n.id,a=n.login,c=n.email,t(Y(s,c,a,!0)));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},$=function(){return function(){var e=Object(c.a)(o.a.mark((function e(t){var r,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:r=e.sent,n=r.data.url,t(Z(n));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B:case X:return Object(u.a)(Object(u.a)({},e),t.payload);default:return e}},ee="INITIALIZED_SUCCESS",te={initialized:!1},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee:return Object(u.a)(Object(u.a)({},e),{},{initialized:!0});default:return e}},ne=r(129),se=r(127),ae=Object(s.c)({profilePage:y,dialogsPage:I,sidebar:N,usersPage:J,app:re,auth:Q,form:se.a}),oe=Object(s.e)(ae,Object(s.a)(ne.a));window.store=oe;var ce=oe,ie=(r(242),r(64)),ue=r.n(ie),le=r(1),je=r.n(le),de=r(23),pe=r(24),fe=r(26),be=r(25),he=(r(246),r(11)),Oe=r(54),me=r.n(Oe),ge=r(13),xe=function(){return Object(n.jsx)("nav",{className:me.a.sidebar,children:Object(n.jsxs)("ul",{children:[Object(n.jsx)("li",{children:Object(n.jsx)(ge.b,{to:"/profile",activeClassName:me.a.activeLink,children:"Profile"})}),Object(n.jsx)("li",{children:Object(n.jsx)(ge.b,{to:"/dialogs",activeClassName:me.a.activeLink,children:"Messages"})}),Object(n.jsx)("li",{children:Object(n.jsx)(ge.b,{to:"/users",activeClassName:me.a.activeLink,children:"Users"})})]})})},ve=r(10),Pe=r(69),_e=r.n(Pe),we=r(132),Se=r.n(we),ye=function(e){return Object(n.jsx)("div",{className:Se.a.dialogItem,children:Object(n.jsx)(ge.b,{to:"/dialogs/"+e.id,children:e.name})})},Ce=function(e){return Object(n.jsx)("div",{children:e.message})},Ue=r(72),Ie=r(33),ke=r.n(Ie),Ne=function(e){e.input;var t=e.meta,r=Object(Ue.a)(e,["input","meta"]),s=t.touched&&t.error;return Object(n.jsxs)("div",{className:ke.a.formControl+" "+(s?ke.a.error:""),children:[Object(n.jsx)("div",{children:r.children}),s&&Object(n.jsx)("div",{className:ke.a.textError,children:t.error})]})},Te=function(e){var t=e.input,r=(e.meta,Object(Ue.a)(e,["input","meta"]));return Object(n.jsx)(Ne,Object(u.a)(Object(u.a)({},e),{},{children:Object(n.jsx)("textarea",Object(u.a)(Object(u.a)({},t),r))}))},Ee=function(e){var t=e.input,r=(e.meta,Object(Ue.a)(e,["input","meta"]));return Object(n.jsx)(Ne,Object(u.a)(Object(u.a)({},e),{},{children:Object(n.jsx)("input",Object(u.a)(Object(u.a)({},t),r))}))},Ae=r(125),Fe=r(126),Le=function(e){if(!e)return"Field is required"},Me=function(e){return function(t){if(t.length>e)return"Max length is ".concat(e," symbols")}},De=Me(50),Ge=Object(Fe.a)({form:"dialogAddMessageForm"})((function(e){return Object(n.jsxs)("form",{onSubmit:e.handleSubmit,children:[Object(n.jsx)(Ae.a,{component:Te,name:"newMessageText",rows:"3",placeholder:"Enter your message",validate:[Le,De]}),Object(n.jsx)("div",{children:Object(n.jsx)("button",{children:"Send"})})]})})),ze=function(e){var t=e.dialogsPage,r=t.dialogs.map((function(e){return Object(n.jsx)(ye,{name:e.name,id:e.id},e.id)})),s=t.messages.map((function(e){return Object(n.jsx)(Ce,{message:e.message,id:e.id},e.id)}));return Object(n.jsxs)("div",{className:_e.a.dialogs,children:[Object(n.jsx)("div",{className:_e.a.dialogItems,children:r}),Object(n.jsxs)("div",{className:_e.a.messages,children:[Object(n.jsx)("div",{children:s}),Object(n.jsx)("div",{children:Object(n.jsx)("div",{children:Object(n.jsx)(Ge,{onSubmit:function(t){e.sendMessageCreator(t.newMessageText)}})})})]})]})},We=function(e){return{isAuth:e.auth.isAuth}},Re=Object(s.d)(Object(ve.b)((function(e){return{dialogsPage:e.dialogsPage}}),(function(e){return{sendMessageCreator:function(t){e(function(e){return{type:C,newMessageText:e}}(t))}}})),(function(e){var t=function(t){Object(fe.a)(s,t);var r=Object(be.a)(s);function s(){return Object(de.a)(this,s),r.apply(this,arguments)}return Object(pe.a)(s,[{key:"render",value:function(){return this.props.isAuth?Object(n.jsx)(e,Object(u.a)({},this.props)):Object(n.jsx)(he.a,{to:"/login"})}}]),s}(je.a.Component);return Object(ve.b)(We)(t)}))(ze),Ve=r(55),He=r.n(Ve),Je=r.p+"static/media/default_avatar.6c764ebb.png",Be=r(38),Xe=r(94),Ke=r.n(Xe),Ye=function(e){for(var t=e.totalItemsCount,r=e.pageSize,s=e.currentPage,a=e.onPageChanged,o=e.portionSize,c=void 0===o?10:o,i=Math.ceil(t/r),u=[],l=1;l<=i;l++)u.push(l);var j=Math.ceil(i/c),d=Object(le.useState)(1),p=Object(Be.a)(d,2),f=p[0],b=p[1],h=(f-1)*c+1,O=f*c;return Object(n.jsxs)("div",{className:Ke.a.pagination,children:[f>1&&Object(n.jsx)("button",{onClick:function(){b(f-1)},children:"PREV"}),u.filter((function(e){return e>=h&&e<=O})).map((function(e){return Object(n.jsx)("span",{className:s===e&&Ke.a.selectedPage,onClick:function(t){a(e)},children:e},e)})),j>f&&Object(n.jsx)("button",{onClick:function(){b(f+1)},children:"NEXT"})]})},Ze=function(e){return Object(n.jsxs)("div",{children:[Object(n.jsx)(Ye,{totalItemsCount:e.totalUsersCount,pageSize:e.pageSize,currentPage:e.currentPage,onPageChanged:e.onPageChanged}),e.users.map((function(t){return Object(n.jsxs)("div",{className:He.a.userItem,children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:He.a.userPhotoWrapper,children:Object(n.jsx)(ge.b,{to:"/profile/"+t.id,children:Object(n.jsx)("img",{className:He.a.userPhoto,src:null!==t.photos.small?t.photos.small:Je,alt:t.name})})}),t.followed?Object(n.jsx)("button",{disabled:e.followingInProgress.some((function(e){return e===t.id})),onClick:function(){e.unfollow(t.id)},children:"Unfollow"}):Object(n.jsx)("button",{disabled:e.followingInProgress.some((function(e){return e===t.id})),onClick:function(){e.follow(t.id)},children:"Follow"})]}),Object(n.jsxs)("div",{className:He.a.userItemInfo,children:[Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{children:t.name}),Object(n.jsx)("div",{children:t.status})]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{children:"user.location.country"}),Object(n.jsx)("div",{children:"user.location.cityName"})]})]})]},t.id)}))]})},qe=r(133),$e=r.n(qe),Qe=r.p+"static/media/preloader.70b176f0.gif",et=function(e){return Object(n.jsx)("div",{className:$e.a.preloaderWrapper,children:Object(n.jsx)("img",{src:Qe,alt:"Loading"})})},tt=function(e){Object(fe.a)(r,e);var t=Object(be.a)(r);function r(){var e;Object(de.a)(this,r);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s))).onPageChanged=function(t){e.props.setCurrentPage(t),e.props.getUsers(t,e.props.pageSize)},e}return Object(pe.a)(r,[{key:"componentDidMount",value:function(){this.props.getUsers(this.props.currentPage,this.props.pageSize)}},{key:"render",value:function(){return Object(n.jsxs)(n.Fragment,{children:[this.props.isFetching?Object(n.jsx)(et,{}):null,Object(n.jsx)(Ze,{totalUsersCount:this.props.totalUsersCount,pageSize:this.props.pageSize,currentPage:this.props.currentPage,onPageChanged:this.onPageChanged,users:this.props.users,follow:this.props.follow,unfollow:this.props.unfollow,followingInProgress:this.props.followingInProgress})]})}}]),r}(je.a.Component),rt=Object(ve.b)((function(e){return{users:e.usersPage.users,pageSize:e.usersPage.pageSize,totalUsersCount:e.usersPage.totalUsersCount,currentPage:e.usersPage.currentPage,isFetching:e.usersPage.isFetching,followingInProgress:e.usersPage.followingInProgress}}),{follow:function(e){return function(){var t=Object(c.a)(o.a.mark((function t(r){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:H(r,e,j.follow.bind(j),z);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},unfollow:function(e){return function(){var t=Object(c.a)(o.a.mark((function t(r){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:H(r,e,j.unfollow.bind(j),W);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},setCurrentPage:function(e){return{type:F,currentPage:e}},toggleFollowingProgress:V,getUsers:function(e,t){return function(){var r=Object(c.a)(o.a.mark((function r(n){var s;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n(R(!0)),r.next=3,j.getUsers(e,t);case 3:s=r.sent,n(R(!1)),n((o=s.items,{type:A,users:o})),n((a=s.totalCount,{type:L,count:a}));case 7:case"end":return r.stop()}var a,o}),r)})));return function(e){return r.apply(this,arguments)}}()}})(tt),nt=r(134),st=r.n(nt),at=r(68),ot=r.n(at),ct=r(135),it=r.n(ct),ut=function(e){return Object(n.jsxs)("div",{className:it.a.post,children:[Object(n.jsx)("img",{src:Je,alt:""}),Object(n.jsx)("span",{children:e.message}),Object(n.jsxs)("div",{children:["Like ",e.like]})]})},lt=Me(10),jt=Object(Fe.a)({form:"addNewPost"})((function(e){return Object(n.jsxs)("form",{onSubmit:e.handleSubmit,children:[Object(n.jsx)(Ae.a,{component:Te,name:"newPostText",row:"2",value:e.newPostText,validate:[Le,lt]}),Object(n.jsx)("button",{className:ot.a.btn,children:"Add post"})]})})),dt=je.a.memo((function(e){var t=e.posts.map((function(e){return Object(n.jsx)(ut,{id:e.id,message:e.message,like:e.like},e.id)}));return Object(n.jsxs)("div",{children:[Object(n.jsx)("h3",{children:"My posts"}),Object(n.jsx)("div",{className:ot.a.postTextarea,children:Object(n.jsx)("div",{children:Object(n.jsx)(jt,{onSubmit:function(t){e.addPost(t.newPostText)}})})}),t]})})),pt=Object(ve.b)((function(e){return{posts:e.profilePage.posts,newPostText:e.profilePage.newPostText}}),(function(e){return{addPost:function(t){e(function(e){return{type:m,newPostText:e}}(t))}}}))(dt),ft=r(136),bt=r.n(ft),ht=function(e){var t=Object(le.useState)(!1),r=Object(Be.a)(t,2),s=r[0],a=r[1],o=Object(le.useState)(e.status),c=Object(Be.a)(o,2),i=c[0],u=c[1];Object(le.useEffect)((function(){u(e.status)}),[e.status]);return Object(n.jsx)("div",{children:s?Object(n.jsxs)("div",{children:[Object(n.jsx)("b",{children:"Status"}),": ",Object(n.jsx)("input",{type:"text",autoFocus:!0,onBlur:function(){a(!1),e.updateUserStatus(i)},onChange:function(e){u(e.currentTarget.value)},value:i})]}):Object(n.jsxs)("div",{children:[Object(n.jsx)("b",{children:"Status"}),": ",Object(n.jsx)("span",{onDoubleClick:function(){a(!0)},children:e.status||"Write the status"})]})})},Ot=r(28),mt=r.n(Ot),gt=function(e){var t=e.contactTitle,r=e.contactValue;return Object(n.jsxs)("div",{children:[Object(n.jsx)("b",{className:mt.a.contactItem,children:t}),": ",Object(n.jsx)("a",{href:r,target:"_blank",children:r})]})},xt=function(e){var t=e.profile,r=e.isOwner,s=e.goToEditMode;return Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{children:r&&Object(n.jsx)("button",{onClick:s,children:"Edit"})}),Object(n.jsxs)("div",{children:[Object(n.jsx)("b",{children:"Full name"}),": ",t.fullName]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("b",{children:"About me"}),": ",t.aboutMe]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("b",{children:"Job description"}),": ",t.lookingForAJobDescription]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("b",{children:"Contacts"}),": ",Object.keys(t.contacts).map((function(e){if(t.contacts[e])return Object(n.jsx)(gt,{contactTitle:e,contactValue:t.contacts[e]},e)}))]})]})},vt=Object(Fe.a)({form:"editProdile"})((function(e){var t=e.handleSubmit,r=e.profile,s=e.error;return Object(n.jsxs)("form",{onSubmit:t,className:mt.a.profileDataForm,children:[Object(n.jsxs)("div",{className:mt.a.formGroup,children:[Object(n.jsx)("b",{children:"Full name"}),":",Object(n.jsx)(Ae.a,{component:Ee,name:"fullName",validate:[Le]})]}),Object(n.jsxs)("div",{className:mt.a.formGroup,children:[Object(n.jsx)("b",{children:"Job description"}),":",Object(n.jsx)(Ae.a,{component:Ee,name:"lookingForAJobDescription",validate:[Le]})]}),Object(n.jsxs)("div",{className:mt.a.formGroup,children:[Object(n.jsx)("b",{children:"About me"}),":",Object(n.jsx)(Ae.a,{component:Te,name:"aboutMe",validate:[Le]})]}),Object(n.jsxs)("div",{children:[Object(n.jsx)("b",{children:"Contacts"}),": ",Object.keys(r.contacts).map((function(e){return Object(n.jsxs)("div",{className:mt.a.formGroup,children:[Object(n.jsx)("b",{children:e}),":",Object(n.jsx)(Ae.a,{component:Ee,name:"contacts."+e})]},e)}))]}),s&&Object(n.jsx)("div",{className:mt.a.hasError,children:s}),Object(n.jsx)("button",{children:"Save"})]})})),Pt=function(e){var t=e.profile,r=e.status,s=e.updateUserStatus,a=e.isOwner,o=e.savePhoto,c=e.saveProfile,i=Object(le.useState)(!1),u=Object(Be.a)(i,2),l=u[0],j=u[1];if(!t)return Object(n.jsx)(et,{});return Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:bt.a.profileAvatar,children:[Object(n.jsx)("img",{src:t.photos.large?t.photos.large:Je,alt:""}),a&&Object(n.jsx)("div",{children:Object(n.jsx)("input",{type:"file",onChange:function(e){e.target.files.length&&o(e.target.files[0])}})}),l?Object(n.jsx)(vt,{initialValues:t,profile:t,onSubmit:function(e){c(e).then((function(){j(!1)}))}}):Object(n.jsx)(xt,{profile:t,isOwner:a,goToEditMode:function(){j(!0)}}),Object(n.jsx)(ht,{status:r,updateUserStatus:s})]})})},_t=function(e){return Object(n.jsxs)("main",{className:st.a.profile,children:[Object(n.jsx)(Pt,{isOwner:e.isOwner,savePhoto:e.savePhoto,saveProfile:e.saveProfile,profile:e.profile,status:e.status,updateUserStatus:e.updateUserStatus}),Object(n.jsx)(pt,{})]})},wt=function(e){Object(fe.a)(r,e);var t=Object(be.a)(r);function r(){return Object(de.a)(this,r),t.apply(this,arguments)}return Object(pe.a)(r,[{key:"refreshProfile",value:function(){var e=this.props.match.params.userId;e||(e=this.props.authorizedUserId)||this.props.history.push("/login"),this.props.getUserProfile(e),this.props.getUserStatus(e)}},{key:"componentDidMount",value:function(){this.refreshProfile()}},{key:"componentDidUpdate",value:function(e,t){this.props.match.params.userId!==e.match.params.userId&&this.refreshProfile()}},{key:"render",value:function(){return Object(n.jsx)(_t,Object(u.a)(Object(u.a)({},this.props),{},{isOwner:!this.props.match.params.userId,profile:this.props.profile,status:this.props.status,updateUserStatus:this.props.updateUserStatus,savePhoto:this.props.savePhoto}))}}]),r}(je.a.Component),St=Object(s.d)(he.f,Object(ve.b)((function(e){return{profile:e.profilePage.profile,status:e.profilePage.status,authorizedUserId:e.auth.userId,isAuth:e.auth.isAuth}}),{getUserProfile:S,getUserStatus:function(e){return function(){var t=Object(c.a)(o.a.mark((function t(r){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.getUserStatus(e);case 2:n=t.sent,r(w(n.data));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},updateUserStatus:function(e){return function(){var t=Object(c.a)(o.a.mark((function t(r){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.updateUserStatus(e);case 2:if(0!==t.sent.data.resultCode){t.next=5;break}return t.abrupt("return",r(w(e)));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},savePhoto:function(e){return function(){var t=Object(c.a)(o.a.mark((function t(r){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.savePhoto(e);case 2:0===(n=t.sent).data.resultCode&&r((s=n.data.data.photos,{type:P,photos:s}));case 4:case"end":return t.stop()}var s}),t)})));return function(e){return t.apply(this,arguments)}}()},saveProfile:function(e){return function(){var t=Object(c.a)(o.a.mark((function t(r,n){var s,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n().auth.userId,t.next=3,d.saveProfile(e);case 3:if(0!==(a=t.sent).data.resultCode){t.next=8;break}r(S(s)),t.next=10;break;case 8:return r(Object(O.a)("editProdile",{_error:a.data.messages[0]})),t.abrupt("return",Promise.reject(a.data.messages[0]));case 10:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()}}))(wt),yt=r(71),Ct=r.n(yt),Ut=function(e){return Object(n.jsxs)("header",{className:Ct.a.header,children:[Object(n.jsx)("div",{className:Ct.a.headerLogo,children:Object(n.jsx)("img",{src:"https://sun9-58.userapi.com/c637526/v637526465/46948/MYX-VzYtTnU.jpg?ava=1",alt:"logo"})}),Object(n.jsx)("div",{className:Ct.a.headerAuth,children:e.isAuth?Object(n.jsxs)("div",{children:[e.login," ",Object(n.jsx)("button",{onClick:e.logout,children:"Log out"})]}):Object(n.jsx)(ge.b,{to:"/login",children:"Login"})})]})},It=function(e){Object(fe.a)(r,e);var t=Object(be.a)(r);function r(){return Object(de.a)(this,r),t.apply(this,arguments)}return Object(pe.a)(r,[{key:"render",value:function(){return Object(n.jsx)(Ut,Object(u.a)({},this.props))}}]),r}(je.a.Component),kt=Object(ve.b)((function(e){return{isAuth:e.auth.isAuth,login:e.auth.login}}),{logout:function(){return function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:0===e.sent.data.resultCode&&t(Y(null,null,null,!1));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})(It),Nt=Object(Fe.a)({form:"login"})((function(e){var t=e.handleSubmit,r=e.error,s=e.captchaUrl;return Object(n.jsxs)("form",{onSubmit:t,children:[Object(n.jsx)("div",{className:ke.a.formGroup,children:Object(n.jsx)(Ae.a,{component:Ee,name:"email",placeholder:"Email",validate:[Le]})}),Object(n.jsx)("div",{className:ke.a.formGroup,children:Object(n.jsx)(Ae.a,{component:Ee,type:"password",name:"password",placeholder:"Password",validate:[Le]})}),Object(n.jsxs)("div",{children:[Object(n.jsx)(Ae.a,{component:Ee,type:"checkbox",name:"rememberMe"})," remember me"]}),s&&Object(n.jsx)("img",{src:s}),r&&Object(n.jsx)("div",{className:ke.a.loginError,children:r}),Object(n.jsx)("div",{children:Object(n.jsx)("button",{children:"Login"})})]})})),Tt=Object(ve.b)((function(e){return{isAuth:e.auth.isAuth,captchaUrl:e.auth.captchaUrl}}),{login:function(e,t,r){return function(){var n=Object(c.a)(o.a.mark((function n(s){var a,c;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f(e,t,r);case 2:0===(a=n.sent).data.resultCode?s(q()):(10===a.data.resultCode&&s($()),c=a.data.messages.length>0?a.data.messages[0]:"Some error",s(Object(O.a)("login",{_error:c})));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}})((function(e){return e.isAuth?Object(n.jsx)(he.a,{to:"/profile"}):Object(n.jsxs)("div",{children:[Object(n.jsx)("h1",{children:"LOGIN"}),Object(n.jsx)(Nt,{onSubmit:function(t){e.login(t.email,t.password,t.rememberMe)},captchaUrl:e.captchaUrl})]})})),Et=function(e){Object(fe.a)(r,e);var t=Object(be.a)(r);function r(){return Object(de.a)(this,r),t.apply(this,arguments)}return Object(pe.a)(r,[{key:"componentDidMount",value:function(){this.props.initializeApp()}},{key:"render",value:function(){return this.props.initialized?Object(n.jsxs)("div",{className:"app-wrapper",children:[Object(n.jsx)(kt,{}),Object(n.jsx)(xe,{}),Object(n.jsxs)("div",{className:"app-content",children:[Object(n.jsx)(he.b,{path:"/profile/:userId?",render:function(){return Object(n.jsx)(St,{})}}),Object(n.jsx)(he.b,{path:"/dialogs",render:function(){return Object(n.jsx)(Re,{})}}),Object(n.jsx)(he.b,{path:"/users",render:function(){return Object(n.jsx)(rt,{})}}),Object(n.jsx)(he.b,{path:"/login",render:function(){return Object(n.jsx)(Tt,{})}})]})]}):Object(n.jsx)(et,{})}}]),r}(je.a.Component),At=Object(s.d)(he.f,Object(ve.b)((function(e){return{initialized:e.app.initialized}}),{initializeApp:function(){return function(e){var t=e(q());Promise.all([t]).then((function(){e({type:ee})}))}}}))(Et);ue.a.render(Object(n.jsx)(ge.a,{children:Object(n.jsx)(ve.a,{store:ce,children:Object(n.jsx)(At,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},33:function(e,t,r){e.exports={formControl:"FormsControls_formControl__3e6x7",error:"FormsControls_error__3A9M9",textError:"FormsControls_textError__ri3fK",loginError:"FormsControls_loginError__22ZeV",formGroup:"FormsControls_formGroup__2h7le"}},54:function(e,t,r){e.exports={sidebar:"Sidebar_sidebar__14grV",activeLink:"Sidebar_activeLink__1eUV0"}},55:function(e,t,r){e.exports={userPhotoWrapper:"Users_userPhotoWrapper__PaKV7",userPhoto:"Users_userPhoto__2R5lm",userItem:"Users_userItem__2Wgve",userItemInfo:"Users_userItemInfo__3cMMX"}},68:function(e,t,r){e.exports={profile:"Posts_profile__3NpXC",postTextarea:"Posts_postTextarea__3L_pb"}},69:function(e,t,r){e.exports={dialogs:"Dialogs_dialogs__3A4Ud"}},71:function(e,t,r){e.exports={header:"Header_header__3ga9x",headerLogo:"Header_headerLogo__3o7L2",headerAuth:"Header_headerAuth__VHTsE"}},94:function(e,t,r){e.exports={pagination:"Pagination_pagination__3yhvl",selectedPage:"Pagination_selectedPage__3o_Ew"}}},[[288,1,2]]]);
//# sourceMappingURL=main.755fa05e.chunk.js.map